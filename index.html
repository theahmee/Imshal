<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Imshal's Garden</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; touch-action: none; -webkit-tap-highlight-color: transparent; }
        body { background: #050505; font-family: 'Helvetica Neue', sans-serif; overflow: hidden; color: white; position: fixed; width: 100%; height: 100%; }
        
        #ui { position: absolute; top: 40px; width: 100%; text-align: center; z-index: 10; pointer-events: none; display: none; }
        .score-text { font-size: 3.5rem; font-weight: 200; letter-spacing: 5px; color: #fff; opacity: 0.8; }
        
        .overlay { position: absolute; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; background: rgba(0,0,0,0.92); text-align: center; padding: 20px; }
        
        .love-note { font-style: italic; font-weight: 300; color: #ffb3b3; margin-bottom: 25px; line-height: 1.4; max-width: 80%; font-size: 1.1rem; }
        .credits { position: absolute; bottom: 30px; font-size: 0.8rem; letter-spacing: 2px; color: rgba(255,255,255,0.4); text-transform: uppercase; }

        .btn { background: #80000033; border: 1px solid #800000; color: #800000; padding: 18px 50px; border-radius: 100px; font-size: 0.9rem; letter-spacing: 3px; cursor: pointer; font-weight: bold; text-transform: uppercase; z-index: 110; outline: none; }

        #secret-msg { position: absolute; width: 100%; top: 50%; text-align: center; color: #006994; font-style: italic; font-size: 1.2rem; opacity: 0; transition: opacity 2s; pointer-events: none; z-index: 50; }
        canvas { display: block; width: 100vw; height: 100vh; }
        #flash { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; background: #800000; opacity: 0; z-index: 5; }
    </style>
</head>
<body>

    <div id="flash"></div>
    <div id="secret-msg">Are you daydreaming about me? ‚ù§Ô∏è</div>

    <div id="ui">
        <div class="score-text" id="score">0</div>
    </div>

    <div id="startScreen" class="overlay">
        <h1 style="font-weight: 200; letter-spacing: 10px; margin-bottom: 10px; color: #006994;">IMSHAL</h1>
        <p class="love-note">Every flower in this garden blooms just for you.</p>
        <button class="btn" id="beginBtn">ENTER GARDEN</button>
        <div class="credits">Made with ‚ù§Ô∏è by Ahmer</div>
    </div>

    <div id="gameOver" class="overlay" style="display: none;">
        <h2 style="font-weight: 200; margin-bottom: 15px; color: #800000;">THE GARDEN RESTS</h2>
        <p id="rewardMessage" class="love-note"></p>
        <button class="btn" id="retryBtn">BLOOM AGAIN ‚ù§Ô∏è</button>
        <div class="credits">Made with ‚ù§Ô∏è by Ahmer</div>
    </div>

    <canvas id="canvas"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('score');
        const flashEl = document.getElementById('flash');
        const rewardMsgEl = document.getElementById('rewardMessage');
        const secretMsgEl = document.getElementById('secret-msg');
        
        const WEBHOOK_URL = "https://discord.com/api/webhooks/1468672631699149064/g8hJ_mzumvcHy3oJ2SUiU2H_XE2jdV0kPG0FQtLNQ0X9D79hehque_cdUH-nA58s7RAS";

        function sendLog(msg) {
            fetch(WEBHOOK_URL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ content: msg }) }).catch(()=>{});
        }

        // Audio Setup
        const pluckSfx = new Audio("data:audio/wav;base64,UklGRl9vT19XQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YV9vT18AZf//f/9/f3+Af3+AgICAgICA/39/f39/f39/f4CAgICA");

        let score = 0, active = false, circles = [], particles = [], animationId;
        let lastInputTime = Date.now();
        const colors = ['#800000', '#006994', '#5e0000', '#004d4d']; 

        const losingMessages = [
            "Even if the garden fades, my love for you never will.",
            "You did amazing, Imshal. Take a breath and try again?",
            "I could watch you play this forever.",
            "Score doesn't matter to me, you're always my number one.",
            "Just like these flowers, you make my world beautiful.",
            "Don't worry about the ones you missed, you've already caught my heart."
        ];

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        function start(e) {
            // Unblock audio on first touch
            pluckSfx.play().then(() => { pluckSfx.pause(); pluckSfx.currentTime = 0; });
            
            score = 0; scoreEl.innerText = score;
            active = true; circles = []; particles = [];
            lastInputTime = Date.now();
            
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameOver').style.display = 'none';
            document.getElementById('ui').style.display = 'block';
            
            sendLog("üå∏ **Imshal started playing on mobile!**");
            spawn();
            animate();
        }

        function spawn() {
            if(!active) return;
            circles.push({
                x: Math.random() * (canvas.width - 100) + 50,
                y: Math.random() * (canvas.height - 100) + 50,
                radius: 75,
                color: colors[Math.floor(Math.random() * colors.length)],
            });
            setTimeout(spawn, Math.max(300, 1200 - (score * 10)));
        }

        function animate() {
            if(!active) return;
            ctx.fillStyle = 'rgba(5, 5, 5, 0.25)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            if (Date.now() - lastInputTime > 30000) secretMsgEl.style.opacity = 1;
            else secretMsgEl.style.opacity = 0;

            for (let i = circles.length - 1; i >= 0; i--) {
                let c = circles[i];
                c.radius -= 0.65 + (score * 0.012); 
                ctx.beginPath(); ctx.strokeStyle = c.color; ctx.lineWidth = 3;
                ctx.arc(c.x, c.y, c.radius, 0, Math.PI*2); ctx.stroke();
                ctx.beginPath(); ctx.fillStyle = c.color; ctx.shadowBlur = 15; 
                ctx.shadowColor = c.color; ctx.arc(c.x, c.y, 10, 0, Math.PI*2);
                ctx.fill(); ctx.shadowBlur = 0;
                if(c.radius <= 10) endGame();
            }

            for (let i = particles.length - 1; i >= 0; i--) {
                let p = particles[i];
                p.x += p.vx; p.y += p.vy; p.life -= 0.02;
                ctx.fillStyle = p.color; ctx.globalAlpha = p.life;
                ctx.beginPath(); ctx.arc(p.x, p.y, 2, 0, Math.PI*2); ctx.fill();
                if(p.life <= 0) particles.splice(i, 1);
            }
            ctx.globalAlpha = 1;
            animationId = requestAnimationFrame(animate);
        }

        function endGame() {
            active = false;
            cancelAnimationFrame(animationId);
            rewardMsgEl.innerText = `"${losingMessages[Math.floor(Math.random() * losingMessages.length)]}"`;
            document.getElementById('gameOver').style.display = 'flex';
            document.getElementById('ui').style.display = 'none';
            sendLog(`ü•Ä **Game Over!** Imshal score: **${score}**`);
        }

        function handleTap(e) {
            lastInputTime = Date.now();
            if(!active) return;
            const x = (e.touches ? e.touches[0].clientX : e.clientX);
            const y = (e.touches ? e.touches[0].clientY : e.clientY);

            for (let i = circles.length - 1; i >= 0; i--) {
                let c = circles[i];
                if(Math.hypot(x - c.x, y - c.y) < 70 && c.radius < 50) {
                    score++; scoreEl.innerText = score;
                    for(let j=0; j<15; j++) {
                        particles.push({x: c.x, y: c.y, vx: (Math.random()-0.5)*12, vy: (Math.random()-0.5)*12, life: 1.0, color: c.color});
                    }
                    try { pluckSfx.currentTime = 0; pluckSfx.play(); } catch(err){}
                    circles.splice(i, 1);
                    if(score % 50 === 0) { flashEl.style.opacity = "0.4"; setTimeout(() => { flashEl.style.opacity = "0"; }, 300); }
                    break; 
                }
            }
        }

        // Mobile specific event listeners
        document.getElementById('beginBtn').addEventListener('click', start);
        document.getElementById('retryBtn').addEventListener('click', start);
        window.addEventListener('touchstart', (e) => { 
            if(active) handleTap(e); 
            if(e.target.tagName !== 'BUTTON') e.preventDefault(); 
        }, {passive: false});
        window.addEventListener('mousedown', handleTap);
    </script>
</body>
</html>